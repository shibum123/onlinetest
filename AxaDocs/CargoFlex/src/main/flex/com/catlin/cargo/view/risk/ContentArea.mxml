<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
		 xmlns:quoteentry="com.catlin.cargo.view.risk.quoteentry.*"
		 xmlns:clauses="com.catlin.cargo.view.risk.clauses.*"
		 xmlns:history="com.catlin.cargo.view.risk.history.*"
		 xmlns:referrals="com.catlin.cargo.view.risk.referrals.*"
		 width="100%"
		 height="100%">


	<mx:Script>
		<![CDATA[
			import com.catlin.cargo.bundles.RB_ui;
			import com.catlin.cargo.model.documents.document.Document;
			import com.catlin.cargo.model.documents.document.DocumentType;
			
			import flash.net.navigateToURL;

			public var debitNoteAvailableToBroker:Boolean;

			[Embed(source='/assets/icons/icon_pdf.gif')]
			private var pdfIconClass:Class;

			[Embed(source='/assets/icons/icon_pdf_unavailable.gif')]
			private var pdfUnavailableIconClass:Class;

			private function openDocument(document:Document):void {
				navigateToURL(new URLRequest("document?documentId=" + document.sid));
			}

			private function getPdfIconClass(document:Document):Class {
				if (document.documentType == DocumentType.DEBIT_NOTE && !debitNoteAvailableToBroker) {
					return pdfUnavailableIconClass;
				}
				return pdfIconClass;
			}

			private function getToolTip(document:Document):String {
				if (document.documentType == DocumentType.DEBIT_NOTE && !debitNoteAvailableToBroker) {
					return resourceManager.getString(RB_ui.RB_NAME, RB_ui.CONTENT_AREA_VIEW_TOOLTOP_NOT_ALLOWED_TO_BROKER);
				}
				return null;
			}
		]]>
	</mx:Script>

		<mx:Canvas width="100%"
				   height="100%"
				   verticalScrollPolicy="off"
				   horizontalScrollPolicy="off">
			<mx:VBox verticalGap="0"
					 width="100%"
					 height="100%">
				<mx:HBox styleName="headlineArea"
						 width="100%">
					<mx:Label id="contentLabel"
							  styleName="headline"/>
					<mx:Text id="contextLabel"
							 paddingTop="5"
							 styleName="contextNormal"
							 width="100%"/>
				</mx:HBox>
				<mx:HBox width="100%">
					<mx:Label id="supersededLabel"
							  text=""
							  styleName="headline"/>
				</mx:HBox>
				<mx:Spacer height="8"/>
				<mx:HBox horizontalAlign="right"
						 width="100%"
						 y="{contentLabel.y}">
					<mx:ButtonBar id="buttonBar"
								  horizontalGap="0"
								  horizontalAlign="right"/>
				</mx:HBox>
				<mx:Spacer height="15"/>
				<mx:TabNavigator id="contentAreaTabNavigator"
								 tabWidth="150" 
								 width="100%"
								 height="100%">
					<quoteentry:QuoteForm id="quoteForm"
										  label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.CONTENT_AREA_VIEW_TAB_NAV_PROPOSAL)}"
										  top="65"
										  left="2"
										  right="2"
										  bottom="10"/>
					<referrals:ReferralReasonsForm id="referralReasonsForm"
												   label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.CONTENT_AREA_VIEW_TAB_NAV_REFERRAL_REASON)}"
												   top="65"
												   left="2"
												   right="2"
												   bottom="10"/>
					<clauses:ClausesForm id="clausesForm"
										 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.CONTENT_AREA_VIEW_TAB_NAV_CLAUSES)}"
										 top="65"
										 left="2"
										 right="2"
										 bottom="10"/>
					<history:HistoryForm id="historyForm"
										 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.CONTENT_AREA_VIEW_TAB_NAV_HISTORY)}"
										 top="65"
										 left="2"
										 right="2"
										 bottom="10"/>
				</mx:TabNavigator>
			</mx:VBox>

			<mx:HBox right="0"
					 horizontalGap="0" 
					 y="{contentAreaTabNavigator.y}">
				<mx:Repeater id="documentRepeater">
					<mx:LinkButton icon="{getPdfIconClass(documentRepeater.currentItem as Document)}"
								   label="{documentRepeater.currentItem.name}"
								   toolTip="{getToolTip(documentRepeater.currentItem as Document)}"
								   fontSize="9" 
								   height="30"
								   verticalCenter="15"   
								   click="openDocument(event.currentTarget.getRepeaterItem() as Document)"/>
				</mx:Repeater>
			</mx:HBox>
		</mx:Canvas>

</mx:VBox>
