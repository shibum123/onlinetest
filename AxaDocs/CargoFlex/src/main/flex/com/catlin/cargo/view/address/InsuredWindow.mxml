<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml"
				minWidth="430"
				title="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_TITLE)}"
				xmlns:tips="com.catlin.cargo.view.help.*"
				xmlns:general="com.catlin.ui.flex.widgets.general.*"
				xmlns:party="com.catlin.cargo.model.core.party.*"
				xmlns:address="com.catlin.cargo.model.geo.address.*"
				xmlns:insured="com.catlin.cargo.model.core.insured.*"
				implements="com.catlin.cargo.view.address.IAddressView"
				xmlns:commonComponents="com.catlin.cargo.view.commonComponents.*">
	<tips:TipHelper id="tipHelper"/>

	<mx:Script>
		<![CDATA[
			import com.catlin.cargo.bundles.CargoLocaleConstants;
			import com.catlin.cargo.bundles.RB_ui;
			
			import mx.controls.Button;
			import mx.core.IContainer;
			import mx.resources.ResourceManager;

			[Bindable]
			private var postCodeLabel:String = ResourceManager
				.getInstance().getString(RB_ui.RB_NAME, RB_ui.POSTAL_CODE(CargoLocaleConstants.COUNTRY_ISO_GB));
			
			public function get addressLine1Component():TextInput {
				return txiAddressLine1;
			}

			public function get addressLine1FormItem():FormItem {
				return fmiAddressLine1;
			}

			public function get addressLine2Component():TextInput {
				return txiAddressLine2;
			}

			public function get addressLine3Component():TextInput {
				return txiAddressLine3;
			}

			public function get townCityComponent():TextInput {
				return txiTownCity;
			}

			public function get townCityFormItem():FormItem {
				return fmiTownCity;
			}

			public function get countyComponent():TextInput {
				return txiCounty;
			}

			public function get provinceComboBox():ComboBox {
				return cboProvince;
			}

			public function get postcodeComponent():TextInput {
				return txiPostcode;
			}

			public function get postcodeFormItem():FormItem {
				return fmiPostcode;
			}

			public function get postcodeLookupActionComponent():Button {
				return btnLookupAddress;
			}

			public function get countryComboBox():ComboBox {
				return cboCountry;
			}

			public function get postcodeLookupTextComponent():TextInput {
				return txiPostcodeToLookup;
			}

			public function showPostcodeLookup(show:Boolean):void {
				fmiPostcodeLookup.includeInLayout=show;
				fmiPostcodeLookup.visible=show;
			}

			public function showCounty(show:Boolean):void {
				fmiCounty.includeInLayout=show;
				fmiCounty.visible=show;
			}

			public function showProvince(show:Boolean):void {
				fmiProvince.includeInLayout=show;
				fmiProvince.visible=show;

				cboProvince.includeInLayout=show;
				cboProvince.visible=show;				
			}

			private var _currentCountryIso:String = CargoLocaleConstants.COUNTRY_ISO_GB;

			[Bindable(event="countryChanged")]
			public function get currentCountryIso():String {
				return _currentCountryIso;
			}
			
			public function set currentCountryIso(value:String):void {
				_currentCountryIso = value;
				updateLabels();
				dispatchEvent(new Event("countryChanged")); 
			}
			
			private function updateLabels():void {
				postCodeLabel = resourceManager.getString(RB_ui.RB_NAME, RB_ui.POSTAL_CODE(_currentCountryIso));
			}

			public function disableAllComponents():void {
				disableAllInputComponents(frmParty);
			}

			protected function disableAllInputComponents(component:Object):void {
				for each (var currentComponent:Object in component.getChildren()) {
					if (currentComponent is IContainer) {
						disableAllInputComponents(currentComponent);
					} else { 
						disableCurrentComponent(currentComponent);
					}
				}
			}

			protected function disableCurrentComponent(currentComponent:Object):void {
				if (currentComponent is TextInput || 
					currentComponent is ComboBox ||
					currentComponent is LinkButton) {
					currentComponent.enabled = false;
				}	
			}

		]]>
	</mx:Script>

	<mx:VBox width="100%"
			 paddingTop="0"
			 height="100%">

		<mx:Form id="frmParty"
				 right="0"
				 width="100%"
				 height="100%"
				 paddingTop="0">
			<mx:FormItem id="fmiName"
						 required="true"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_INSUREDNAME)}"
						 width="100%">
				<mx:TextInput id="txiName"
							  width="100%"
							  maxChars="512"/>
			</mx:FormItem>
			<mx:FormItem label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_COUNTRY)}"
						 width="100%">
				<general:ComboBox id="cboCountry"
								  width="100%"
								  prompt="Select"/>
			</mx:FormItem>
			<mx:FormItem id="fmiPostcodeLookup"
						 label="{postCodeLabel}"
						 direction="horizontal"
						 width="100%">
				<mx:TextInput id="txiPostcodeToLookup"
							  width="70"
							  toolTip="{tipHelper.getTips(txiPostcodeToLookup, RB_ui.TOOLTIP_GENERAL_POSTCODE)}"
							  maxChars="10"/>
				<mx:LinkButton id="btnLookupAddress"
							   styleName="link"
							   label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_LOOKUPADDRESS)}"/>
			</mx:FormItem>
			<mx:FormItem id="fmiAddressLine1"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_ADDRESSLINE,['1'])}"
						 width="100%">
				<mx:TextInput id="txiAddressLine1"
							  width="100%"
							  maxChars="32"/>
			</mx:FormItem>
			<mx:FormItem id="fmiAddressLine2"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_ADDRESSLINE,['2'])}"
						 width="100%">
				<mx:TextInput id="txiAddressLine2"
							  width="100%"
							  maxChars="32"/>
			</mx:FormItem>
			<mx:FormItem id="fmiAddressLine3"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_ADDRESSLINE,['3'])}"
						 width="100%">
				<mx:TextInput id="txiAddressLine3"
							  width="100%"
							  maxChars="32"/>
			</mx:FormItem>
			<mx:FormItem id="fmiTownCity"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_CITY)}"
						 required="true"
						 width="100%">
				<mx:TextInput id="txiTownCity"
							  width="100%"
							  maxChars="32"/>
			</mx:FormItem>
			<mx:FormItem id="fmiCounty"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_COUNTY)}"
						 width="100%">
				<mx:TextInput id="txiCounty"
							  width="100%"
							  maxChars="32"/>
			</mx:FormItem>
			<mx:FormItem id="fmiProvince"
						 label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.INSURED_WINDOW_PROVINCE)}"
						 width="100%">
				<general:ComboBox id="cboProvince"
							  width="100%"
							  prompt="Select"/>
			</mx:FormItem>
			<mx:FormItem id="fmiPostcode"
						 label="{postCodeLabel}"
						 required="true">
				<mx:TextInput id="txiPostcode"
							  width="70"
							  maxChars="10"/>
			</mx:FormItem>
		</mx:Form>

		<commonComponents:ConfirmationButtonBar id="buttonBar" okLabel="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.ADD)}"/>

	</mx:VBox>
</mx:TitleWindow>
