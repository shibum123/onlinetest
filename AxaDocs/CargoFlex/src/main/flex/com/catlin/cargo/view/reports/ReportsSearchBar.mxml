<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml"
		 currentState="expanded"
		 width="100%">

	<mx:Script>
		<![CDATA[
			import com.catlin.cargo.ApplicationFacade;
			import com.catlin.cargo.bundles.RB_ui;
			
			import mx.controls.Alert;
			import mx.events.CalendarLayoutChangeEvent;
			

			[Bindable]
			[Embed(source='/assets/icons/icon_minus_16x16.png')]
			private var colapseClass:Class;


			[Bindable]
			[Embed(source='/assets/icons/icon_plus_16x16.png')]
			private var expandClass:Class;

			// This will be a proper object to send to the server.
			public function currentSelection():Array {
				return null;
			}

			public function showSearchFilters(value:Boolean):void {
				value ? currentState='expanded' : currentState='collapsed';
			}

			protected function onChangeStateClickHandler(event:MouseEvent):void {
				currentState == 'collapsed' ? currentState='expanded' : currentState='collapsed';
				trace("currentState: " + currentState);
			}
			
			protected function dfiEndDate_changeHandler(event:CalendarLayoutChangeEvent):void
			{
				// TODO Auto-generated method stub
				Alert.show("Data Cahnged");
				
			}
			
		]]>
	</mx:Script>


	<mx:Fade id="fadeOut"
			 duration="600"
			 alphaFrom="1.0"
			 alphaTo="0.0"/>
	<mx:Fade id="fadeIn"
			 duration="600"
			 alphaFrom="0.0"
			 alphaTo="1.0"/>

	<mx:transitions>
		<mx:Transition id="exapandTransition"
					   fromState="*"
					   toState="expanded">
			<mx:Resize target="{mainContainerBox}"
					   duration="400"/>
		</mx:Transition>
		<mx:Transition id="colapseTransition"
					   fromState="*"
					   toState="collapsed">
			<mx:Resize target="{mainContainerBox}"
					   duration="400"/>
		</mx:Transition>
	</mx:transitions>

	<mx:states>

		<mx:State name="collapsed">

			<mx:SetProperty target="{btnGenerate}"
							name="visible"
							value="false"/>
			<mx:SetProperty target="{btnGenerate}"
							name="includeInLayout"
							value="false"/>

			<mx:SetProperty target="{btnExportToExcel}"
							name="visible"
							value="false"/>
			<mx:SetProperty target="{btnExportToExcel}"
							name="includeInLayout"
							value="false"/>

			<mx:SetProperty target="{btnExportToCSV}"
							name="visible"
							value="false"/>
			<mx:SetProperty target="{btnExportToCSV}"
							name="includeInLayout"
							value="false"/>

			<mx:AddChild relativeTo="{containerBox}">
				<mx:HBox horizontalAlign="right"
						 id="collapsedBox"
						 width="100%"
						 hideEffect="{fadeOut}"
						 showEffect="{fadeIn}"
						 visible="{currentState == 'collapsed'}">
					<mx:Label text="Expand the view to redefine your filters."
							  y="-7"
							  textAlign="right"
							  width="100%"/>
				</mx:HBox>
			</mx:AddChild>

		</mx:State>

		<mx:State name="expanded">

			<mx:SetProperty target="{btnGenerate}"
							name="visible"
							value="true"/>
			<mx:SetProperty target="{btnGenerate}"
							name="includeInLayout"
							value="true"/>

			<mx:SetProperty target="{btnExportToExcel}"
							name="visible"
							value="true"/>
			<mx:SetProperty target="{btnExportToExcel}"
							name="includeInLayout"
							value="true"/>

			<mx:SetProperty target="{btnExportToCSV}"
							name="visible"
							value="true"/>
			<mx:SetProperty target="{btnExportToCSV}"
							name="includeInLayout"
							value="true"/>
			<mx:AddChild relativeTo="{containerBox}">

				<mx:HBox width="100%"
						 height="100%"
						 hideEffect="{fadeOut}"
						 showEffect="{fadeIn}"
						 visible="{currentState == 'expanded'}"
						 id="expandedBox">

					<mx:VBox horizontalAlign="left"
							 height="100%">
						<mx:FormItem label="Master Office"
									 required="true"
									 id="masterOfficeFormItem"
									 labelWidth="90">
							<mx:ComboBox id="cboMasterOffice"
										 width="100"
										 dropdownWidth="350"
										 rowCount="20"/>
						</mx:FormItem>

						<mx:FormItem label="Broker Office"
									 required="true"
									 labelWidth="90">
							<mx:ComboBox id="cboBrokerOffice"
										 width="100"
										 dropdownWidth="350"
										 rowCount="20"/>
						</mx:FormItem>
					</mx:VBox>

					<mx:VBox horizontalAlign="left"
							 height="100%">
						<mx:FormItem label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.REPORTS_START_DATE)}"
									 horizontalAlign="right"
									 labelWidth="90">
							<mx:DateField id="dfiStartDate"
										  editable="true"
										  yearNavigationEnabled="true" 
										  formatString="{ApplicationFacade.getInstance().localeFormat.dateShort4Year2MonthDay}"
										  width="100"/>
						</mx:FormItem>
						<mx:FormItem label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.REPORTS_END_DATE)}"
									 horizontalAlign="right"
									 labelWidth="90">
							<mx:DateField id="dfiEndDate"
										  editable="true"
										  yearNavigationEnabled="true"
										  formatString="{ApplicationFacade.getInstance().localeFormat.dateShort4Year2MonthDay}"
										  width="100"/>
						</mx:FormItem>
					</mx:VBox>

					<mx:HBox height="100%"
							 width="100%">
						<mx:Label text="Status"
								  y="-7"/>
						<mx:TileList id="tileRiskStatus"
									 width="100%"
									 maxWidth="400"
									 maxColumns="4"
									 columnWidth="95"
									 height="60"
									 direction="horizontal"
									 verticalScrollPolicy="auto"
									 horizontalScrollPolicy="off"
									 labelField="name"
									 allowMultipleSelection="true"/>
					</mx:HBox>

				</mx:HBox>
			</mx:AddChild>
		</mx:State>

	</mx:states>

	<mx:ApplicationControlBar width="100%"
							  paddingLeft="10"
							  cornerRadius="0"
							  horizontalGap="10"
							  paddingTop="5"
							  paddingBottom="2"
							  verticalAlign="middle"
							  id="mainContainerBox">

		<mx:Label text="Filters"
				  fontWeight="bold"/>

		<mx:HBox width="100%"
				 height="100%"
				 id="containerBox"/>

		<mx:HBox id="iconBox"
				 height="100%"
				 horizontalAlign="right"
				 verticalAlign="middle"
				 paddingLeft="1"
				 paddingRight="1"
				 paddingTop="1"
				 paddingBottom="1">
			<mx:LinkButton
					  buttonMode="true"
					  id="btnGenerate"
					  label="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.REPORTS_BUTTON_GENERATE)}"
					  skin="{null}" 
					  icon="@Embed(source='/assets/icons/icon_executeReport_24x24.png')"
					  toolTip="{resourceManager.getString(RB_ui.RB_NAME, RB_ui.REPORTS_BUTTON_GENERATE)}"
					  height="22"/>
			<mx:Image buttonMode="true"
					  id="btnExportToExcel"
					  maintainAspectRatio="true"
					  source="@Embed(source='/assets/icons/icon_exel_24x24.png')"
					  toolTip="Export to Excel (2007)"
					  height="22"/>
			<mx:Image buttonMode="true"
					  id="btnExportToCSV"
					  maintainAspectRatio="true"
					  source="@Embed(source='/assets/icons/icon_csv_24x24.png')"
					  toolTip="Copy to Clipboard (CSV)"
					  height="22"/>

			<mx:Image buttonMode="true"
					  id="btnExpandColapse"
					  maintainAspectRatio="true"
					  source="{currentState == 'collapsed' ? expandClass : colapseClass}"
					  height="22"
					  click="onChangeStateClickHandler(event)"/>
		</mx:HBox>

	</mx:ApplicationControlBar>

</mx:VBox>
